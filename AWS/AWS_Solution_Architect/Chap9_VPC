VPC - Amazon Virtual Private Cloud 
    - provision a logically isolated section of AWS Cloud
    - a private user defined network
    - user have complete control over this private network: private IP address rage, subnets, route tables and network gateways

    Private IP address:
        -> 10.0.0.0 - 10.255.255.255 (10/8 prefix)
        -> 172.16.0.0 - 172.31.255.255 (172.16/12 prefix)
        -> 192.168.0.0 - 192.168.255.255 (192.168/16 prefix)
    
    Default VS vs Custom VPC
        -> Default VPC is user friendly
        -> All submets in default VPC have a route to internet
        -> EC2 instance has both public and private IP address
    
    VPC Peering - to connect one VPC to another
        -> instance behave as if they were on the same private network
        -> can peer with other AWS account VPC
        -> NO TRANSITIVE PEERING! - no brigding. FOr example:
            A <---> B, B <---> C: B can talk to A and C, but A cannot talk to C and likewise

EXAM TIPS:
-> VPC is logical datacenter in AWS
-> Consist of Internet Gateways (IGWs), Route Tables, Network Access Control Lists, Subnets, and Security Groups
-> 1 Subnet = 1 AZ
-> Security Groups are Stateful, Network Access Control Lists are Stateless
-> NO TRANSITIVE PEERING

LAB PART 1
-> Reserved IPaddress - when creating a new subnets
    10.0.0.0: network address
    10.0.0.1: for VPC router
    10.0.0.2: DNS server
    10.0.0.3: for future use
    10.0.0.255: network broadcast address, AWS doesn't support broad cast in VPC, therefore AWS reserve this address
-> A new VPC comes with: default Route Table (main), Network Access Control List (NACL), default Security Groups
-> A new VPC won't create: Subnets, IGW
-> AZs are randomized

LAB PART2

LAB Part3
-> NAT: Network Address Transmission
-> NAT Gateway
    + Redundant inside AZ
    + Prefered by the enterprise
    + 5Gbps - 45Gbps
-> NAT Instance 
    + disable source/destination check on the instance
    + must be on public subnet

NACL
    -> A NACL can associate with multiple Subnets, but a subnet can only associate with 1 NACL
    -> contain a list of rule, evaluated in order
    -> stateless: inbound/outbound

Load Balancer:
    1. Application Load Balancer
    2. Network Load Balancer
    3. Classic Load Balancer

VPC Flow Logs
    -> capture information about the IP traffic going to and from network interfaces in VPC
    -> using CloudWatch Logs
    -> 3 levels: VPC > Subnets > Network Interface Level (eni)
    -> enable for peered VPC in the same account (cannot with 2 VPC in different accounts)
    -> tags
    -> Once flow logs is set, no after modifications
    -> IP that won't be monitored:
        + Traffic generated by instances when they contact Amazon DS server, unless use your own DNS server
        + traffic generated by Windows instance for Amazon Windows license activation
        + traffic to and from 169.254.169.254 for instance metadata
        + DHCP traffic
        + traffic to reserved IP address for default router

Bastion Host (Jump Box)
    -> securely administer EC2 instances (SSH/RDP) 
    -> Internet Traffic > router > ACL > Nat GW/Instance > Bastion > (SSH/RDP) > Instances

Direct connect
    -> dedicated/privated physical network connection from prem (data center, office, apps) to AWS Cloud Service
    -> low cost, high bandwidth throughput, consistent vs Internet-based connections

    On-prem -> AWS DX -> AWS Cloud

Direct connect Creation
    1. Create a virtual interface in the Direct Connect console: Public Virtual Interface
    2. Go to VPC console > VPN connections > create a Customer Gateway
    3. Create a Virtual Private Gateway
    4. Attach the Virtual Private Gateway
    5. Select VPN Connections and create new VPN Connection
    6. Select the Virtual private Gateway and the Customer Gateway
    7. Once VPN is available, setup the VPN on the customer gateway or firewall

Global Accelerator 
-> a service to improve availability and performance of your applications for local and global users
    Components:
        -> Static IP addresses: AWS provides 2 static IP, user can bring their own
        -> Accelerator:
            + direct traffic to optimal endpoints
            + each Accelerator includes one or more Listeners
        -> DNS Name:
            + random. Ex: a1234.awsglobalaccelerator.com
            + point to provided static IP addresses
            + can be setup to route traffic using custom Domain Name
        -> Network Zone: 
            + similar to AZ, a network zone is an isolated unit with physical infrastructure
            + service static IP address
            + One IP down, traffic will be routed to another IP from a healthy isolated Network Zone
        -> Listener:
            + processes inbound connections from Client -> Global Accelerator based on port (or port range) + configured protocol
            + Global Accelerator supports TCP + UDP
            + Each Listener has one or more Endpoint Groups
        -> Endpoint Groups:
            + each Endpoint associate with an AWS region
            + Endpoint Groups = one ore more endpoints in the Region
            + Traffic Dial = distribute traffic to Endpoints according to their weight percentage
            + Traffic Dial provide performance testing or blue/green deployment testing for new releases across different AWS Region
        -> Endpoint:
            + Endpoint can be eight: NLB, ALB, EC2 Instances, or Elastic IP addresses
            + If Endpoint = ALB, can be internet-facing (public) or internal (private)
            + Endpoint Weight: numbers of traffic proportion to route to each Endpoint

AWS Private Link - The best way to expose VPC to multiple customer VPC
    -> To open a VPC <---> another VPC there are 3 ways:
        1. Open it up to the internet publicly
            Negative: everything on public subnet will be accessed publicly, a lot to manage
        2. Use VPC Peering
            Negative: has to create and manage many peering relationships, 100 VPC =  100 Peering, time consuming
        3. AWS Private Link
            -> doesn't require VPC peering, no route table, NAT, IGWs, etc.
            -> requires a NLB on the service VPC and an ENI on customer VPC

Transit Gateway
-> transitive peering between thousand of VPCs + on-prem datacenters
-> hub-and-spoke model: direct from point-point
-> regional basis, can have it across multiple regions
-> works with RAM (Resource Access Manager) to use across multiple AWS accounts
-> works with route table to limit how VPCs talk to each others
-> works with Direct Connect, VPN 
-> support IP multicast

VPN CloudHub
-> hub-and-spoke model
-> connect multiple site via centralized VPN connections
-> low cost, easy to manage
-> encrypted during transmit

Network Consist
-> private IP is cheaper than public IP
-> Bundle everything inside one AZ will be network cost free but single point of failure

VPC FINAL EXAM TIPS (reviewstrat.txt)
-> VPC similar to logical datacenter in AWS
-> consists of Internet Gateway (IGWs or Virtual Private Gateways), Route Tables, Network Access Control Lists (NACL), Subnets, and Security Groups
-> 1 subnet = 1 AZ
-> Security Group is Stateful
-> Network Access Control List is Stateless
-> NO TRANSITIVE PEERING
-> New VPC consist default Route Tablet, NACL, default Security Group
-> New VPC will not create subnet, nor default IGW (you have to create them)
-> US-EAST-1A in one account can be a completely different AZ to US-EAST-1A in another acocunt. AZs are randomized
-> ONLY 1 IGW per VPC (AWS takes care of IGW HA)
-> Security Groups can't span VPCs = different VPC has their own SG sets

NAT INSTANCES EXAM TIPS
-> Have to: Disable Source/Destination Check in the Instance
-> Have to: be on public subnet
-> Have to: route private subnet to NAT INSTANCE

    Private Subnet                      Public Subnet         
    ====================                ==================
    Private EC2 instance    -------->   NAT INSTANCE        -----------> INTERNET
                                        (Disable Src/Dest)           
    ====================                ==================
-> amount of traffic that NAT INSTANCE can support depends on the instance size = increase instance size if bottlenecking
-> NAT INSTANCES HA = (Create multiple NAT INSTANCE across AZs) + (script to automate failover) + (Autoscaling Group)
-> Behind Security Groups

NAT GATEWAYS EXAM TIPS
-> Have to: be on Public subnet
-> Have to: route private SN to NATE GATEWAY
-> Have to: update route tables
-> Not behind Security Group
-> AWS takes care
    + HA: Redundant inside AZ
    + Patching
-> Preferred by enterprise
-> Start 5Gbps -> 45 Gbps
-> Automatically assigned public ip address
-> NAT Gateway set in one AZ can be shared/accessed by resource from other AZ 
        -> if that NAT AZ down, all resource from other AZ will lost connection
        -> should create NAT GATEWAY in EACH AZ!
-> CHOOSE NAT GATEWAYS over NAT INSTANCES ALWAYS!

NACL EXAM TIPS
-> allow all inbound and outbound traffic by default
-> can create custom network ACL to deny all until adding more rules
-> Each Subnet must associate with 1 NACL (bound with default NACL by default)
-> A NACL can associate with multiple Subnets
-> To block IP Addresses, use NACL, NOT Security Groups
-> Rules in NACL are evaluated in order, lowest number first
-> Stateless: response to allowed inbound are subject for outbound 

ELB and VPC EXAM TIPS
-> Need 2 public subnets to deploy an internet facing load balancer

VPC FLOW LOGS EXAM TIPS
-> can tag 
-> cannot enable for peered VPC on another account (unless VPC is in your account)
-> cannot modify after Creation
-> Exclude IP that are not monitored:
    + traffic to Amazon DNS (custon DNS server will be monitored)
    + traffic to Windows instance for Amazon Windows License activation
    + 169.254.169.254 instance metadata
    + reserved UP for default VPC router
    + DHCP IP

BASTION EXAM TIPS
    + Jumpbox
    + used to securely administer EC2 instances (SSH or RDP)
    + Cannot use a NAT Gateway as Bastion (NAT provide internet traffic to instance in private SN, Bastion administer EC2 instance SSH/RDP only)

DIRECT CONNECT EXAM TIPS
-> Steps to create Direct Connect:
    1. Create a (public) virtual interface in Direct Connect console. This is a PUBLIC Virtual Interface
    2. Go to VPC console -> VPN connections -> create Customer Gateway
    3. Create Virtual Private Gateway
    4. Attach Virtual Private Gateway to VPC
    5. Select VPN connections -> create new VPC connection
    6. Select Virtual Private Gateway -> Customer Gateway
    7. Once VPN is available, setup VPN on customer gateway/firewall

GLOBAL ACCELERATOR EXAM TIPS
-> improve availability + performance of application for local + global users
-> provided 2 static IP (can bring custom)
-> traffic dials: distribute traffic by weight via endpoint Groups

VPC ENDPOINTS EXAM TIPS
-> privately connect VPC to AWS service
-> powered by PrivateLink = no need for internet gateway, NAT, VPN, Direct Connect
-> traffic does not leave AWS network
-> Endpoints are virtuals
-> horizontally scaled, redundant, HA = high bandwidth
-> Interface Endpoints vs Gateway Endpoints
    + Inter support a lot of AWS services
    + Gateway support only S3 and DynamoDB

PRIVATE LINK EXAM TIPS
-> Peering VPC to TENS, HUNDREDS, or THOUSANDS of customer VPCs
-> NOT requiring NAT, IGW, etc.
-> Require: a NLB on service VPC <----> an ENI on customer VPC

TRANSIT GATEWAY EXAM TIPS
-> "Simply network connections", "Support Multicast"
-> tansitive peering between VPCs <--> on-prem 
-> hub-to-spoke model
-> Regional, can go multi-regional
-> Works with Resource Access Manager to use across AWS accounts
-> Works with Direct Connect
-> Works with VPN

VPN CLOUDHUB EXAM TIPS
-> centralize VPN connections between sites
-> hub-and-spoke
-> encrypted, low cost

NETWORK COST EXAM TIPS
-> Private IP > Public IP
-> trade cost to HA